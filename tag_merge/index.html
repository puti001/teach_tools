<html>
<head>
    <meta charset="UTF-8">
    <title>Puti-AI 標籤合併列印助手</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script type="importmap">
    {
        "imports": {
            "html2canvas": "https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.esm.min.js"
        }
    }
    </script>
    <script type="module" src="script.js"></script>
</head>
<body>
    <div class="container">
        <div class="settings-panel">
          <h1>Puti-AI標籤合併列印助手</h1>
          <h2>標籤設定</h2>
            
            <div class="section">
                <h3>匯入 Excel</h3>
                <input type="file" id="fileInput" accept=".xlsx,.xls">
                <div id="columnSelection" class="column-selection">
                    <p>選擇要匯入的欄位：</p>
                    <!-- 動態產生欄位勾選 -->
                </div>
            </div>

            <div class="section">
                <h3>版面設定</h3>
                <div class="setting-group">
                    <label>每列標籤數：</label>
                    <input type="number" id="labelsPerRow" value="2" min="1" max="5">
                </div>
                <div class="setting-group">
                    <label>每欄標籤數：</label>
                    <input type="number" id="labelsPerCol" value="5" min="1" max="10">
                </div>
                <div class="setting-group">
                    <label>字體大小：</label>
                    <input type="number" id="fontSize" value="12" min="8" max="24">
                </div>
                <div class="setting-group">
                    <label>字型：</label>
                    <select id="fontFamily">
                        <option value="PMingLiU">新細明體</option>
                        <option value="Microsoft JhengHei">微軟正黑體</option>
                        <option value="DFKai-SB">標楷體</option>
                    </select>
                </div>
            </div>

            <div class="section">
                <h3>邊距設定</h3>
                <div class="setting-group">
                    <label>頁面邊距 (mm)：</label>
                    <input type="number" id="pageMargin" value="10" min="0" max="50">
                </div>
                <div class="setting-group">
                    <label>標籤內邊距 (mm)：</label>
                    <input type="number" id="labelPadding" value="5" min="0" max="20">
                </div>
            </div>

            <div class="section">
                <h3>顯示選項</h3>
                <div class="setting-group">
                    <label>
                        <input type="checkbox" id="showFieldNames">
                        顯示欄位名稱
                    </label>
                </div>
            </div>

            <button id="generatePDF" class="primary-button">產生 PDF</button>
        </div>

        <div class="preview-panel">
            <h2>預覽</h2>
            <div id="previewContainer" class="a4-preview">
                <!-- 預覽內容會動態產生 -->
            </div>
        </div>
    </div>
</body>
</html>